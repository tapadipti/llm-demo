schema: '2.0'
stages:
  expand:
    cmd: bash expand_data.sh
    deps:
    - path: docs_dump.zip
      hash: md5
      md5: 2dfe0f1dbd30ef26e75cbaa56e6e9fec
      size: 470834
    - path: expand_data.sh
      hash: md5
      md5: 6aca8ab03e2fa106e81b21d04ba2adb7
      size: 229
    outs:
    - path: data
      hash: md5
      md5: d3406c3230f9614c651b531a33a6a869.dir
      size: 20724476
      nfiles: 262
  ingest:
    cmd: python ingest.py
    deps:
    - path: data
      hash: md5
      md5: d3406c3230f9614c651b531a33a6a869.dir
      size: 20724476
      nfiles: 262
    - path: ingest.py
      hash: md5
      md5: d0f292bc230c286ee2930728e2a046e7
      size: 657
    params:
      params.yaml:
        TextSplitter:
          chunk_size: 1500
          chunk_overlap: 200
          keep_separator: false
          add_start_index: false
    outs:
    - path: docs.json
      hash: md5
      md5: 56dc37bab9c16deac65ff3a836be05c1
      size: 806099
    - path: metadatas.json
      hash: md5
      md5: 0c50c613202d5bfedfcfccfe52abfc4e
      size: 10985
  vectorize:
    cmd: python vector_store.py
    deps:
    - path: docs.json
      hash: md5
      md5: 56dc37bab9c16deac65ff3a836be05c1
      size: 806099
    - path: metadatas.json
      hash: md5
      md5: 0c50c613202d5bfedfcfccfe52abfc4e
      size: 10985
    - path: vector_store.py
      hash: md5
      md5: 1d50ba5d19938e49fa5d7e2b4a9ed649
      size: 982
    params:
      params.yaml:
        OpenAIEmbeddings:
          chunk_size: 1000
          embedding_ctx_length: 8191
          max_retries: 6
          model: text-embedding-ada-002
    outs:
    - path: docs.index
      hash: md5
      md5: 00d04d3463b7e4d39040fa1b7fe642c7
      size: 7258157
    - path: faiss_store.pkl
      hash: md5
      md5: c3da5d5b725963b639f34ac816ae9eb4
      size: 833170
  run:
    cmd: python qa.py
    deps:
    - path: canfy.csv
      hash: md5
      md5: f4d4c1221515fe413e7cdf383c1ab2db
      size: 6467
    - path: docs.index
      hash: md5
      md5: 00d04d3463b7e4d39040fa1b7fe642c7
      size: 7258157
    - path: faiss_store.pkl
      hash: md5
      md5: c3da5d5b725963b639f34ac816ae9eb4
      size: 833170
    - path: qa.py
      hash: md5
      md5: 4f1b8f2ffb564c3ce9754f2068d6fdef
      size: 1452
    params:
      params.yaml:
        ChatOpenAI:
          max_retries: 6
          model_name: gpt-3.5-turbo
          temperature: 0.0
          verbose: true
        Retrieval:
          max_tokens_limit: 3375
          reduce_k_below_max_tokens: false
          verbose: true
    outs:
    - path: results.csv
      hash: md5
      md5: abc3984ca29f773365bba04570133081
      size: 4601
  setup:
    cmd: bash setup.sh
    deps:
    - path: requirements.txt
      hash: md5
      md5: 7879f8f8d504fc5f1494df3ba23b96c7
      size: 2275
    - path: setup.sh
      hash: md5
      md5: 1881cad25780801542082d6721a35d2f
      size: 374
  eval:
    cmd: python eval.py
    deps:
    - path: canfy.csv
      hash: md5
      md5: f4d4c1221515fe413e7cdf383c1ab2db
      size: 6467
    - path: eval.py
      hash: md5
      md5: 0245cd5e0416c0384486fdafc9d84540
      size: 1204
    - path: results.csv
      hash: md5
      md5: abc3984ca29f773365bba04570133081
      size: 4601
    outs:
    - path: eval.csv
      hash: md5
      md5: 59a1528dc10d73afed3bde3ab2016241
      size: 391
